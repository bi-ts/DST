language: cpp
matrix:
  include:
  - os: osx
    osx_image: xcode11.6
    compiler: clang
before_script:
- brew update
- brew outdated cmake || brew upgrade cmake
- cmake --version
script:
- mkdir build
- cd build
- cmake -DCMAKE_INSTALL_PREFIX="../dst-$TRAVIS_TAG" -G"Xcode" ..
- cmake --build . --config Release
- ctest -V -C Release .
- cmake --build . --config Debug
- ctest -V -C Debug .
- cmake --build . --target install
- cd ..
- zip -r -X "dst-$TRAVIS_TAG.zip" "dst-$TRAVIS_TAG"
deploy:
  provider: releases
  api_key:
    secure: hSxZ2EvTczWi+Dqo8eUQabpr4Q9LX84KCvWfMWLoCRbf2bGZjkDHKgbjCoRcIav+21SnvHRhJn0N+7QBNjKppPiu1Pi//tzV2d+2aTluRTf8fR57/CDpFIBiV7pIQM6uSKYfqBb0s1lGkW8823AzzjfcoZXhanCkmK0M5cbN1DzfuGBGqp875ZAYky9mZjJ9COTrAl1/WQyn55iaf41pvSC2xpXml9qmwiErIRkte7o2KotICODAL1PnHXWorQ31zp8PCzgmCWAjOH/ap3HyBDeTcky+g4RJnRDhHEM8v8AM/H3cfhaT6r6WkHLtw/cuoBLK5pbAAmJ2kh3oP9v/sxQhryaGrZSLKiSRGvaOJd1CIIEGrD+9NFUr00RROKXgaRcDzPlaSQmjZAjOJZ3tVCBWjP9rbVjlZWYTTY6TMrtqSEUcz2fy32TOgAIWF2m0s0Q/3cBQFPRVIGTtZShnC16hJhCkZI0RirgMmxiHrU05CE35C0ZCj0T9pQdVXDlRwMfwaA9A2dpCIEBRix0WM3cVGoKGznEqZggmVrMl6lCt61J9dS60t8sEh8QNIL+wsp5stHqxuZrbYQi7qT8KzrsISiHJr5+IiXTVlM1aLXppjIJzcY5xFGTbM6N8t9bM3Q5xs+r1fmYHu3BpVIkuA3Dzv9CxRsq5O8db3SzA+cw=
  file: "dst-$TRAVIS_TAG.zip"
  skip_cleanup: true
  overwrite: true
  on:
    tags: true
